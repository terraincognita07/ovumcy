{{define "content"}}
<section class="space-y-6">
  <div>
    <h1 class="journal-title">{{t .Messages "settings.title"}}</h1>
    <p class="journal-muted mt-2">{{t .Messages "settings.subtitle"}}</p>
  </div>

  {{if .SuccessKey}}
  <div class="status-ok flex items-center gap-2"><span aria-hidden="true">âœ…</span><span>{{t .Messages .SuccessKey}}</span></div>
  {{end}}

  {{if .ErrorKey}}
  <div class="status-error flex items-center gap-2"><span aria-hidden="true">âš ï¸</span><span>{{t .Messages .ErrorKey}}</span></div>
  {{end}}

  <section class="journal-card p-5 sm:p-6">
    <h2 class="journal-subtitle">ğŸ”’ {{t .Messages "settings.change_password.title"}}</h2>
    <p class="journal-muted mt-2 text-sm">{{t .Messages "settings.change_password.subtitle"}}</p>

    <form action="/api/settings/change-password" method="post" class="mt-5 space-y-4">
      <input type="hidden" name="csrf_token" value="{{.CSRFToken}}">

      <label class="field-label" for="settings-current-password">{{t .Messages "settings.current_password"}}</label>
      <input id="settings-current-password" type="password" name="current_password" required autocomplete="current-password" class="input-field">

      <label class="field-label" for="settings-new-password">{{t .Messages "auth.new_password"}}</label>
      <input id="settings-new-password" type="password" name="new_password" required autocomplete="new-password" class="input-field">
      <p class="journal-muted text-xs">{{t .Messages "auth.password_requirements"}}</p>

      <button type="submit" class="btn-primary">{{t .Messages "settings.change_password.submit"}}</button>
    </form>
  </section>

  <section class="journal-card p-5 sm:p-6">
    <h2 class="journal-subtitle">ğŸ”‘ {{t .Messages "settings.recovery_code.title"}}</h2>
    <p class="journal-muted mt-2 text-sm">{{t .Messages "settings.recovery_code.subtitle"}}</p>

    <form
      action="/api/settings/regenerate-recovery-code"
      method="post"
      class="mt-5"
      data-confirm="{{t .Messages "settings.confirm_regenerate_recovery_code"}}"
      data-confirm-accept="{{t .Messages "settings.recovery_code.submit"}}">
      <input type="hidden" name="csrf_token" value="{{.CSRFToken}}">
      <button type="submit" class="btn-secondary">{{t .Messages "settings.recovery_code.submit"}}</button>
    </form>

    {{if .GeneratedRecoveryCode}}
    <div class="mt-5 space-y-3">
      <p class="field-label">{{t .Messages "settings.recovery_code.generated_title"}}</p>
      <div class="recovery-code-box">{{.GeneratedRecoveryCode}}</div>
      <p class="journal-muted text-xs">{{t .Messages "settings.recovery_code.generated_subtitle"}}</p>
    </div>
    {{end}}
  </section>

  <section class="journal-card border border-red-200 p-5 sm:p-6">
    <h2 class="journal-subtitle text-red-700">âš ï¸ {{t .Messages "settings.danger_zone.title"}}</h2>
    <p class="journal-muted mt-2 text-sm">{{t .Messages "settings.danger_zone.subtitle"}}</p>

    <form
      hx-delete="/api/settings/delete-account"
      hx-target="#delete-account-feedback"
      hx-swap="innerHTML"
      hx-confirm="{{t .Messages "settings.confirm_delete_account"}}"
      data-confirm-accept="{{t .Messages "settings.delete_account.submit"}}"
      class="mt-5 space-y-4">
      <input type="hidden" name="csrf_token" value="{{.CSRFToken}}">

      <label class="field-label" for="settings-delete-password">{{t .Messages "settings.delete_account.password"}}</label>
      <input id="settings-delete-password" type="password" name="password" required autocomplete="current-password" class="input-field">

      <button type="submit" class="btn-danger">{{t .Messages "settings.delete_account.submit"}}</button>
      <div id="delete-account-feedback" class="save-status text-sm"></div>
    </form>
  </section>
</section>
{{end}}
