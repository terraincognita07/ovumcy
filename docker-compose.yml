services:
  ovumcy:
    image: ${OVUMCY_IMAGE:-ghcr.io/terraincognita07/ovumcy:latest}
    container_name: ovumcy
    env_file:
      - ./.env
    environment:
      - TZ=${TZ:-UTC}
      - DEFAULT_LANGUAGE=${DEFAULT_LANGUAGE:-ru}
      - DB_PATH=/app/data/ovumcy.db
      - COOKIE_SECURE=${COOKIE_SECURE:-false}
      - RATE_LIMIT_LOGIN_MAX=${RATE_LIMIT_LOGIN_MAX:-8}
      - RATE_LIMIT_LOGIN_WINDOW=${RATE_LIMIT_LOGIN_WINDOW:-15m}
      - RATE_LIMIT_FORGOT_PASSWORD_MAX=${RATE_LIMIT_FORGOT_PASSWORD_MAX:-8}
      - RATE_LIMIT_FORGOT_PASSWORD_WINDOW=${RATE_LIMIT_FORGOT_PASSWORD_WINDOW:-1h}
      - RATE_LIMIT_API_MAX=${RATE_LIMIT_API_MAX:-300}
      - RATE_LIMIT_API_WINDOW=${RATE_LIMIT_API_WINDOW:-1m}
      - TRUST_PROXY_ENABLED=${TRUST_PROXY_ENABLED:-false}
      - PROXY_HEADER=${PROXY_HEADER:-X-Forwarded-For}
      - TRUSTED_PROXIES=${TRUSTED_PROXIES:-127.0.0.1,::1}
    init: true
    security_opt:
      - no-new-privileges:true
    cap_drop:
      - ALL
    read_only: true
    tmpfs:
      - /tmp
    volumes:
      - ovumcy_data:/app/data
    ports:
      - "8080:8080"
    restart: unless-stopped

volumes:
  ovumcy_data:
    name: ovumcy_data